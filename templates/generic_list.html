{% extends "baselayout.html" %}
{% load i18n %}
{% load render_table from django_tables2 %}

{% block extracss %}
<link href="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/css/select2.min.css" type="text/css" media="screen" rel="stylesheet">
{% endblock %}

{% block content %}

<div class="row">
    <div class="col-xs-10">
        <div class="panel panel-default">
            <div class="panel-heading">
              <h4 class="panel-title">
                <a data-toggle="collapse" href="#collapse1">Filter <span class="glyphicon glyphicon-chevron-down"></span></a>
              </h4>
            </div>
            <div id="collapse1" class="panel-collapse collapse">
              <div class="panel-body">
                <form action="" method="get">
                    <table class="table">
                    {{ filter.form.as_table }}
                    </table>
                    <div class="pull-right">
                        <input type="submit" class="btn"/>
                        <a href='{{ request.path }}' class="btn">Clear</a>
                    </div>
                </form>
              </div>
            </div>
          </div>
    </div>
</div>

<div class="row">
    <div class="col-xs-10">
        {% if object_name_plural %}
            <h1>{{ object_name_plural|title }} </h1>
        {% else %}
            <h1>{{ object_name|title }}s</h1>
        {% endif %}
        <div class="small">Displaying {{ filter.qs.count }} of {{ filter.queryset.count }}</div>
        {% if table %}
            {% render_table table %}
        {% else %}
            <div>No {{ object_name}}s.</div>
        {% endif %}
    </div>
    <div class="col-xs-2">
        <h3>Actions</h3>
        <ul>
            <li>
                <a href="{{ add_url }}">Create new</a>
            </li>
        </ul>
    </div>
</div>

<!-- Delete Modal -->
<div id="deleteModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title"><span class="glyphicon glyphicon-warning-sign"></span> {% trans "Warning" %}</h4>
      </div>
      <div class="modal-body">
        <p>{% trans "Are you sure you want to delete this entry?" %}</p>
      </div>
      <div class="modal-footer">
        <!-- Since the confirmation is done in this modal, the deletion is done using a POST.
        A GET would trigger a confirm page. -->
        <form id="delete-form" method="POST" action="">
           {% csrf_token %}
        </form>
        <a class="btn btn-danger" href="" id="delete-link"
               onclick="document.getElementById('delete-form').submit(); return false;">{% trans "Yes" %}</a>
        <button type="button" class="btn btn-success" data-dismiss="modal">{% trans "No" %}</button>
      </div>
    </div>

  </div>
</div>

{% endblock %}

{% block extrajs %}

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/js/select2.min.js"></script>

<script>
$(document).ready(function(){
        $('.delete-entry').on('click', function() {
            var url = $(this).attr('modal_url');
            $('#delete-form').attr('action', url);
            $('#delete-link').attr('href', url);
        });

        $('[data-toggle="tooltip"]').tooltip({
            placement : 'bottom'
        });
});
</script>
{% endblock %}